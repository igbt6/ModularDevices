package com.app.modulardevice.modulardeviceapp;
import com.app.modulardevice.modulardeviceapp.model.ModuleVariable;

import org.junit.Test;


import static org.junit.Assert.*;
/**
 * Created by igbt6 on 26.10.2015.
 */
public class VariableEquationParserUnitTest {

    @Test
    public void isParsingCorrectly() throws Exception {
        ModuleVariable mVar = new ModuleVariable("Temperature","d[1] * 2","","");
        Byte[] dataTab= new Byte[]{0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00, 0x00, 0x00,0x00,0x00,0x00,0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        assertEquals((double)4, mVar.computeEquation(dataTab),0.1);
    }


    @Test
    public void isParsingCorrectly2() throws Exception {
        ModuleVariable mVar = new ModuleVariable("Pressure","d[0]*16777216+d[2]+65536*d[1]*256/d[3]","","");
        Byte[] dataTab= new Byte[]{0x01,0x02,0x03,0x04,0x00,0x00,0x00,0x00,0x00, 0x00, 0x00,0x00,0x00,0x00,0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        assertEquals((double) 29360137, mVar.computeEquation(dataTab), 100);
    }

    @Test
    public void isParsingCorrectly3() throws Exception {
        ModuleVariable mVar = new ModuleVariable("BatTemp","(d[0]*256+d[1])/65535*600-273.15","","");
        Byte[] dataTab= new Byte[]{0x01,0x02,0x03,0x04,0x00,0x00,0x00,0x00,0x00, 0x00, 0x00,0x00,0x00,0x00,0x00,0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
        assertEquals((double) -270.79, mVar.computeEquation(dataTab), 0.1);
    }
}
